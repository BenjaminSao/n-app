{"version":3,"file":"page-component-factory.js","sourceRoot":"","sources":["../../src/core/page-component-factory.ts"],"names":[],"mappings":"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","sourcesContent":["import { ComponentFactory } from \"./component-factory\";\nimport { Utils } from \"./utils\";\nimport { PageRegistration } from \"./page-registration\";\n\n\nexport class PageComponentFactory extends ComponentFactory\n{\n    public create(registration: PageRegistration): Object\n    {\n        let component: any = super.create(registration);\n        \n        /* The Full Navigation Resolution Flow\n                Navigation triggered\n                Call leave guards in deactivated components\n                Call global beforeEach guards\n                Call beforeRouteUpdate guards in reused components (2.2+)\n                Call beforeEnter in route configs\n                Resolve async route components\n                Call beforeRouteEnter in activated components\n                Call global beforeResolve guards (2.5+)\n                Navigation confirmed.\n                Call global afterEach hooks.\n                DOM updates triggered.\n                Call callbacks passed to next in beforeRouteEnter guards with instantiated instances.\n         */\n        \n        component.beforeRouteEnter = function (to: any, from: any, next: any)\n        {\n            // called before the route that renders this component is confirmed.\n            // does NOT have access to `this` component instance,\n            // because it has not been created yet when this guard is called!\n            \n            let routeArgs: Array<any> = [];\n            \n            if (registration.route.params.length > 0)\n            {\n                try \n                {\n                    routeArgs = Utils.createRouteArgs(registration.route, to);\n                }\n                catch (error)\n                {\n                    console.log(error);\n                    next(false);\n                    return;\n                }\n            }  \n            \n            next((vueModel: any) =>\n            {\n                let vm = vueModel.vm;\n                if (vm.onEnter)\n                    vm.onEnter(...routeArgs);\n            });\n        };\n        \n        component.beforeRouteUpdate = function (to: any, from: any, next: any)\n        {\n            // called when the route that renders this component has changed,\n            // but this component is reused in the new route.\n            // For example, for a route with dynamic params /foo/:id, when we\n            // navigate between /foo/1 and /foo/2, the same Foo component instance\n            // will be reused, and this hook will be called when that happens.\n            // has access to `this` component instance.\n\n            \n            if (registration.route.params.length === 0)\n            {\n                next();\n                return;\n            }    \n            \n            let routeArgs: Array<any> = [];\n            try \n            {\n                routeArgs = Utils.createRouteArgs(registration.route, to);\n            }\n            catch (error)\n            {\n                console.log(error);\n                next(false);\n                return;\n            }\n            \n            let fromRouteArgs: Array<any> = [];\n            try \n            {\n                fromRouteArgs = Utils.createRouteArgs(registration.route, from);\n            }\n            catch (error) \n            {\n                console.log(error);\n                fromRouteArgs = [];\n            }\n\n            if (routeArgs.equals(fromRouteArgs))\n            {\n                next();\n                return;\n            }   \n            \n            let vm = this.vm;\n            if (vm.onLeave)\n                vm.onLeave();    \n            \n            if (vm.onEnter)\n                vm.onEnter(...routeArgs);\n            \n            next();\n        };\n        \n        component.beforeRouteLeave = function (to: any, from: any, next: any)\n        {\n            // called when the route that renders this component is about to\n            // be navigated away from.\n            // has access to `this` component instance.\n\n            let vm = this.vm;\n            if (vm.onLeave)\n                vm.onLeave();\n            \n            next();\n        };\n        \n        return component;\n    }\n}"]}