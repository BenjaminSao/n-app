{"version":3,"file":"utilities.js","sourceRoot":"","sources":["../../src/core/utilities.ts"],"names":[],"mappings":";;AAAA,6CAAmD;AACnD,iBAAe;AACf,mDAA+C;AAG/C;IAEW,MAAM,CAAC,gBAAgB,CAAC,GAAQ;QAEnC,IAAI,aAAa,GAAG,IAAI,KAAK,EAAgB,CAAC;QAC9C,IAAI,SAAS,GAAG,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;QAC3C,EAAE,CAAC,CAAC,SAAS,KAAK,SAAS,IAAI,SAAS,KAAK,IAAI,CAAC;YAC9C,MAAM,CAAC,aAAa,CAAC;QAEzB,IAAI,QAAQ,GAAG,CAAC,KAAK,EAAE,UAAU,EAAE,SAAS,EAAE,WAAW,EAAE,iBAAiB,EAAE,kBAAkB;YAC5F,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;QAE1D,IAAI,SAAS,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO;YACpG,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ;YACrG,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,WAAW,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;QAElH,IAAI,aAAa,GAAG,MAAM,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;QACpD,GAAG,CAAC,CAAC,IAAI,IAAI,IAAI,aAAa,CAAC,CAC/B,CAAC;YACG,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YACnB,EAAE,CAAC,CAAC,IAAI,KAAK,aAAa,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC;gBACzG,QAAQ,CAAC;YAEb,EAAE,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC;gBAChC,MAAM,IAAI,kCAAoB,CAAC,SAAkB,GAAI,CAAC,WAAW,EAAE,0CAA0C,IAAI,yCAAyC,SAAS,GAAG,CAAC,CAAC;YAE5K,IAAI,UAAU,GAAG,MAAM,CAAC,wBAAwB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YAC5D,aAAa,CAAC,IAAI,CAAC,IAAI,4BAAY,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;QAC3D,CAAC;QAED,aAAa,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;QAC7D,MAAM,CAAC,aAAa,CAAC;IACzB,CAAC;CAoFJ;AApHD,8BAoHC","sourcesContent":["import { ApplicationException } from \"n-exception\";\nimport \"n-ext\";\nimport { PropertyInfo } from \"./property-info\";\n\n\nexport class Utilities\n{\n    public static getPropertyInfos(val: any): Array<PropertyInfo>\n    {\n        let propertyInfos = new Array<PropertyInfo>();\n        let prototype = Object.getPrototypeOf(val);\n        if (prototype === undefined || prototype === null)  // we are dealing with Object\n            return propertyInfos;\n            \n        let internal = [\"ctx\", \"onCreate\", \"onMount\", \"onDestroy\", \"executeOnCreate\", \"executeOnDestroy\",\n            \"watch\", \"unWatch\", \"getBound\", \"onEnter\", \"onLeave\"];\n        \n        let forbidden = [\"do\", \"if\", \"for\", \"let\", \"new\", \"try\", \"var\", \"case\", \"else\", \"with\", \"await\", \"break\",\n            \"catch\", \"class\", \"const\", \"super\", \"throw\", \"while\", \"yield\", \"delete\", \"export\", \"import\", \"return\",\n            \"switch\", \"default\", \"extends\", \"finally\", \"continue\", \"debugger\", \"function\", \"arguments\", \"typeof\", \"void\"];\n        \n        let propertyNames = Object.getOwnPropertyNames(val);\n        for (let name of propertyNames)\n        {\n            name = name.trim();\n            if (name === \"constructor\" || name.startsWith(\"_\") || name.startsWith(\"$\") || internal.some(t => t === name))\n                continue;\n\n            if (forbidden.some(t => t === name))\n                throw new ApplicationException(`Class ${(<Object>val).getTypeName()} has a member with the forbidden name '${name}'. The following names are forbidden: ${forbidden}.`);    \n            \n            let descriptor = Object.getOwnPropertyDescriptor(val, name);\n            propertyInfos.push(new PropertyInfo(name, descriptor));\n        }\n\n        propertyInfos.push(...Utilities.getPropertyInfos(prototype));\n        return propertyInfos;\n    }\n    \n    // public static createRouteArgs(route: RouteInfo, ctx: any): Array<any>\n    // {\n    //     let pathParams = ctx.params ? ctx.params : {};\n    //     let queryParams = ctx.query ? ctx.query : {};\n    //     let model: { [index: string]: any } = {};\n\n    //     for (let param of route.params)\n    //     {\n    //         let lookupKey = param.paramKey.trim().toLowerCase();\n    //         let value = null;\n    //         if (param.isQuery)\n    //         {\n    //             for (let key in queryParams)\n    //             {\n    //                 if (key.trim().toLowerCase() === lookupKey)\n    //                 {\n    //                     value = param.parseParam(queryParams[key]);\n    //                     break;\n    //                 }    \n    //             }\n                \n    //             if (value === undefined || value === null)\n    //             {\n    //                 if (!param.isOptional)\n    //                     throw new HttpException(404);\n                    \n    //                 value = null;\n    //             }    \n    //         }\n    //         else\n    //         {\n    //             for (let key in pathParams)\n    //             {\n    //                 if (key.trim().toLowerCase() === lookupKey)\n    //                 {\n    //                     value = param.parseParam(pathParams[key]);\n    //                     break;\n    //                 }\n    //             }\n\n    //             if (value === undefined || value === null)\n    //                 throw new HttpException(404);\n    //         }\n            \n    //         model[param.paramKey] = value;\n    //     }    \n\n        \n    //     // for (let key in queryParams)\n    //     // {\n    //     //     let routeParam = route.findRouteParam(key);\n    //     //     if (!routeParam)\n    //     //         continue;\n\n    //     //     model[routeParam.paramKey] = routeParam.parseParam(queryParams[key]);\n    //     // }\n\n    //     // for (let key in pathParams) // this wont work in multi level nesting\n    //     // {\n    //     //     let routeParam = route.findRouteParam(key);\n    //     //     if (!routeParam)\n    //     //         throw new HttpException(404);\n\n    //     //     model[routeParam.paramKey] = routeParam.parseParam(pathParams[key]);\n    //     // }\n\n    //     let result = [];\n    //     for (let param of route.params.orderBy(t => t.order))\n    //     {\n    //         let value = model[param.paramKey];\n    //         // if (value === undefined || value === null)\n    //         // {\n    //         //     if (!param.isOptional)\n    //         //         throw new HttpException(404);\n\n    //         //     value = null;\n    //         // }\n    //         result.push(value);\n    //     }\n\n    //     return result;\n    // }\n}\n\n\n\n\n\n\n"]}